# ğŸ“Š Dataset Merger - Visual Overview

## System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     DATASET MERGER SYSTEM                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚                               â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  INPUT LAYER   â”‚            â”‚  CONFIG LAYER   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚                               â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  myDatasets/   â”‚            â”‚ merger_config   â”‚
        â”‚  - BPLD        â”‚            â”‚    .json        â”‚
        â”‚  - Rice        â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚  - Okra        â”‚
        â”‚  - ...         â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚         PROCESSING PIPELINE                    â”‚
        â”‚                                                â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
        â”‚  â”‚  1. DATASET SCANNER                    â”‚   â”‚
        â”‚  â”‚  - Recursive file search               â”‚   â”‚
        â”‚  â”‚  - Format detection                    â”‚   â”‚
        â”‚  â”‚  - Class label extraction              â”‚   â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
        â”‚               â”‚                                â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
        â”‚  â”‚  2. IMAGE ANALYZER                     â”‚   â”‚
        â”‚  â”‚  - MD5 hashing                         â”‚   â”‚
        â”‚  â”‚  - Perceptual hashing                  â”‚   â”‚
        â”‚  â”‚  - Resolution & quality scoring        â”‚   â”‚
        â”‚  â”‚  - Metadata extraction                 â”‚   â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
        â”‚               â”‚                                â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
        â”‚  â”‚  3. DEDUPLICATION ENGINE               â”‚   â”‚
        â”‚  â”‚  - Group by MD5 (exact)                â”‚   â”‚
        â”‚  â”‚  - Group by perceptual hash (similar)  â”‚   â”‚
        â”‚  â”‚  - Quality-based selection             â”‚   â”‚
        â”‚  â”‚  - Provenance tracking                 â”‚   â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
        â”‚               â”‚                                â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
        â”‚  â”‚  4. SIMILARITY CLUSTERER               â”‚   â”‚
        â”‚  â”‚  - DBSCAN clustering                   â”‚   â”‚
        â”‚  â”‚  - Binary vector conversion            â”‚   â”‚
        â”‚  â”‚  - Hamming distance calculation        â”‚   â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
        â”‚               â”‚                                â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
        â”‚  â”‚  5. DATASET SPLITTER                   â”‚   â”‚
        â”‚  â”‚  - Holdout set creation (10%)          â”‚   â”‚
        â”‚  â”‚  - Stratified splitting                â”‚   â”‚
        â”‚  â”‚  - Cluster-aware distribution          â”‚   â”‚
        â”‚  â”‚  - Source diversity enforcement        â”‚   â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
        â”‚               â”‚                                â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
        â”‚  â”‚  6. FILE ORGANIZER                     â”‚   â”‚
        â”‚  â”‚  - Directory structure creation        â”‚   â”‚
        â”‚  â”‚  - Image copying                       â”‚   â”‚
        â”‚  â”‚  - Name conflict resolution            â”‚   â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
        â”‚               â”‚                                â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
        â”‚  â”‚  7. REPORT GENERATOR                   â”‚   â”‚
        â”‚  â”‚  - CSV exports                         â”‚   â”‚
        â”‚  â”‚  - Markdown summaries                  â”‚   â”‚
        â”‚  â”‚  - Statistics calculation              â”‚   â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚              OUTPUT LAYER                      â”‚
        â”‚                                                â”‚
        â”‚  merged_output/                                â”‚
        â”‚  â”œâ”€â”€ merged_dataset/                           â”‚
        â”‚  â”‚   â”œâ”€â”€ train/                                â”‚
        â”‚  â”‚   â”‚   â”œâ”€â”€ Class1/Dataset1/images            â”‚
        â”‚  â”‚   â”‚   â””â”€â”€ Class2/Dataset2/images            â”‚
        â”‚  â”‚   â”œâ”€â”€ val/                                  â”‚
        â”‚  â”‚   â”œâ”€â”€ test/                                 â”‚
        â”‚  â”‚   â””â”€â”€ holdout/                              â”‚
        â”‚  â”‚                                             â”‚
        â”‚  â””â”€â”€ reports/                                  â”‚
        â”‚      â”œâ”€â”€ merged_metadata.csv                   â”‚
        â”‚      â”œâ”€â”€ provenance_map.csv                    â”‚
        â”‚      â”œâ”€â”€ duplicates_report.csv                 â”‚
        â”‚      â”œâ”€â”€ similarity_clusters.csv               â”‚
        â”‚      â”œâ”€â”€ split_files_list.csv                  â”‚
        â”‚      â””â”€â”€ MERGE_SUMMARY.md                      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Data Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Dataset   â”‚
â”‚   Sources   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€â”€ BPLD Dataset â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”œâ”€â”€â”€ Rice Dataset â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”œâ”€â”€â”€ Okra Dataset â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â””â”€â”€â”€ Other Datasets â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                                     â”‚
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚  Scan & Collect â”‚
                            â”‚   (Scanner)     â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚  Raw Image Records  â”‚
                          â”‚   ~10,000+ images   â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚  Extract        â”‚
                            â”‚  Metadata       â”‚
                            â”‚  (Analyzer)     â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚  Enriched Metadata  â”‚
                          â”‚  + Hashes + Quality â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                                 â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚  MD5 Grouping     â”‚           â”‚  Perceptual Hash    â”‚
          â”‚  (Exact Dupes)    â”‚           â”‚  (Similar Images)   â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                                 â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚  Deduplicated Set   â”‚
                      â”‚  ~8,000+ unique     â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚  Cluster        â”‚
                        â”‚  Formation      â”‚
                        â”‚  (DBSCAN)       â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚  Clustered Images   â”‚
                      â”‚  Groups: ~500       â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                         â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  Holdout Set (10%)  â”‚   â”‚  Remaining (90%)  â”‚
         â”‚  ~800 images        â”‚   â”‚  ~7,200 images    â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                             â”‚
                                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                â”‚                         â”‚
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚  Train Set (70%)    â”‚   â”‚  Val+Test (30%)   â”‚
                     â”‚  ~5,040 images      â”‚   â”‚  ~2,160 images    â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                         â”‚
                                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                             â”‚                       â”‚
                                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                                  â”‚  Val Set (15%)      â”‚  â”‚  Test Set (15%) â”‚
                                  â”‚  ~1,080 images      â”‚  â”‚  ~1,080 images  â”‚
                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Quality Scoring Breakdown

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    QUALITY SCORE (0-100)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Resolution (40 pts) â”‚  Higher resolution = better quality
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  0-1MP:   0-20 pts   â”‚  Low quality
â”‚  1-2MP:  20-30 pts   â”‚  Medium quality
â”‚  2-3MP:  30-35 pts   â”‚  Good quality
â”‚  3MP+:   35-40 pts   â”‚  Excellent quality
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Aspect Ratio (10 pts)â”‚  Standard ratios preferred
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  0.5-2.0:  10 pts    â”‚  Normal (portrait/landscape)
â”‚  Other:     5 pts    â”‚  Unusual (very wide/tall)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Sharpness (30 pts)  â”‚  Laplacian variance (blur detection)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  <50:     0-10 pts   â”‚  Very blurry
â”‚  50-100: 10-20 pts   â”‚  Slightly blurry
â”‚  100+:   20-30 pts   â”‚  Sharp
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ File Size (20 pts)   â”‚  Optimal range: 50KB - 5MB
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  <50KB:    10 pts    â”‚  Too compressed
â”‚  50KB-5MB: 20 pts    â”‚  Optimal
â”‚  >5MB:     15 pts    â”‚  Too large
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Example:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Image: anthracnose_001.jpg         â”‚
â”‚  Resolution: 1920x1080 (2MP)        â”‚
â”‚  Aspect: 1.78 (16:9)                â”‚
â”‚  Sharpness: 150 (sharp)             â”‚
â”‚  Size: 850KB                        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚  Resolution Score:  30/40           â”‚
â”‚  Aspect Score:      10/10           â”‚
â”‚  Sharpness Score:   25/30           â”‚
â”‚  Size Score:        20/20           â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚  TOTAL QUALITY:     85/100 â­â­â­â­   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Deduplication Strategy

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              DEDUPLICATION PIPELINE                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

STEP 1: MD5 HASHING (Exact Duplicates)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Image A: healthy_leaf_001.jpg  â†’ MD5: a1b2c3d4...
Image B: healthy_leaf_002.jpg  â†’ MD5: a1b2c3d4...  â† DUPLICATE!
Image C: healthy_leaf_003.jpg  â†’ MD5: e5f6g7h8...

Action: Keep highest quality (Image A: 85pts vs Image B: 72pts)
Result: Remove Image B, keep provenance


STEP 2: PERCEPTUAL HASHING (Near-Duplicates)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Image A: disease_leaf.jpg       â†’ pHash: 1010101010101010...
Image D: disease_leaf_rot90.jpg â†’ pHash: 1010111010101010...  
                                  Hamming Distance: 2 â† SIMILAR!

Action: If distance â‰¤ threshold (5), keep highest quality
Result: Remove Image D (rotated version)


STEP 3: PROVENANCE TRACKING
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Record for Image B (removed):
  - image_id: a1b2c3d4...
  - dataset_source: "Rice Dataset"
  - original_path: "Rice Dataset/train/healthy/..."
  - kept: False
  - reason: "duplicate_of_healthy_leaf_001.jpg"

Record for Image A (kept):
  - image_id: a1b2c3d4...
  - dataset_source: "BPLD Dataset"  
  - original_path: "BPLD Dataset/Healthy/..."
  - kept: True
  - reason: "best_quality"
```

## Clustering Visualization

```
DBSCAN Clustering on Perceptual Hashes
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Binary Vectors (64-bit perceptual hashes):
Image 1: [1,0,1,0,1,1,0,0,1,1,0,1,...]  â”€â”
Image 2: [1,0,1,0,1,1,0,1,1,1,0,1,...]  â”€â”¼â”€ Cluster 1
Image 3: [1,0,1,1,1,1,0,0,1,1,0,1,...]  â”€â”˜   (Similar)

Image 4: [0,1,0,1,0,0,1,1,0,0,1,0,...]  â”€â”
Image 5: [0,1,0,1,0,0,1,0,0,0,1,0,...]  â”€â”¼â”€ Cluster 2
Image 6: [0,1,1,1,0,0,1,1,0,0,1,1,...]  â”€â”˜   (Similar)

Image 7: [1,1,1,1,0,0,0,0,1,1,1,1,...]  â”€â”€â”€ Noise (-1)
                                             (Outlier)

Clustering Parameters:
  eps = 0.3          (max hamming distance)
  min_samples = 2    (min points per cluster)
  metric = hamming   (binary distance)

Result:
  Cluster  1: 3 images (kept together in splits)
  Cluster  2: 3 images (kept together in splits)
  Noise   -1: 1 image  (distributed freely)
```

## Split Strategy Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              STRATIFIED SPLIT CREATION                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Input: 8,000 unique images, 15 classes, 500 clusters
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

PHASE 1: HOLDOUT SEPARATION (10%)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Goal: Diverse, unseen domains

Strategy:
  1. Group by Dataset Ã— Class
  2. Sort by size (smallest first)
  3. Take 10% from diverse sources
  
Example:
  Okra Dataset â†’ Anthracnose:     5 images  â†’ 1 to holdout
  Rice Dataset â†’ Bacterial Leaf:  50 images â†’ 5 to holdout
  BPLD Dataset â†’ Healthy:         100 imagesâ†’ 10 to holdout
  
Result: 800 images in holdout (10 datasets, 15 classes)


PHASE 2: REMAINING SPLIT (90% â†’ Train/Val/Test)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Remaining: 7,200 images
Adjusted ratios: 70/15/15 â†’ 77.8/16.7/16.7

For each class:
  1. Group images by cluster
  2. Distribute clusters to splits
  3. Maintain class balance

Example - "Anthracnose" class:
  Total: 480 images in 30 clusters
  
  Clusters 1-21  â†’ Train (336 images, 70%)
  Clusters 22-26 â†’ Val   (72 images, 15%)
  Clusters 27-30 â†’ Test  (72 images, 15%)

Benefits:
  âœ“ Similar images stay together (no leakage)
  âœ“ Each split has all classes (stratified)
  âœ“ Clusters prevent overfitting
```

## Output Structure

```
merged_output/
â”œâ”€â”€ merged_dataset/               # Organized images
â”‚   â”œâ”€â”€ train/                    # 70% of remaining (5,040)
â”‚   â”‚   â”œâ”€â”€ Anthracnose/
â”‚   â”‚   â”‚   â”œâ”€â”€ BPLD Dataset/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ anthracnose_001.jpg
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ anthracnose_002.jpg
â”‚   â”‚   â”‚   â””â”€â”€ Okra DiseaseNet Dataset/
â”‚   â”‚   â”‚       â””â”€â”€ okra_anth_001.jpg
â”‚   â”‚   â”œâ”€â”€ Bacterial Leaf Blight/
â”‚   â”‚   â”œâ”€â”€ Healthy/
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ val/                      # 15% of remaining (1,080)
â”‚   â”‚   â””â”€â”€ [same structure]
â”‚   â”‚
â”‚   â”œâ”€â”€ test/                     # 15% of remaining (1,080)
â”‚   â”‚   â””â”€â”€ [same structure]
â”‚   â”‚
â”‚   â””â”€â”€ holdout/                  # 10% of total (800)
â”‚       â””â”€â”€ [same structure]
â”‚
â””â”€â”€ reports/                      # Analysis & tracking
    â”œâ”€â”€ merged_metadata.csv       # All image metadata
    â”‚   # Columns: image_path, canonical_class, 
    â”‚   #          dataset_source, md5_hash, 
    â”‚   #          perceptual_hash, resolution,
    â”‚   #          quality_score, ...
    â”‚
    â”œâ”€â”€ provenance_map.csv        # Complete provenance
    â”‚   # Columns: image_id, dataset_source,
    â”‚   #          original_path, kept, reason
    â”‚
    â”œâ”€â”€ duplicates_report.csv     # Removed duplicates
    â”‚   # Filters provenance where kept=False
    â”‚
    â”œâ”€â”€ similarity_clusters.csv   # Clustering results
    â”‚   # Columns: image_path, canonical_class,
    â”‚   #          cluster_id
    â”‚
    â”œâ”€â”€ split_files_list.csv      # Split assignments
    â”‚   # Columns: image_path, canonical_class,
    â”‚   #          dataset_source, split
    â”‚
    â””â”€â”€ MERGE_SUMMARY.md          # Human-readable summary
        # - Statistics
        # - Distributions
        # - Quality metrics
        # - Next steps
```

## Usage Examples

```bash
# Basic usage
python dataset_merger.py

# With custom config
python dataset_merger.py custom_config.json

# Expected output:
# ğŸ” Scanning datasets...
#   ğŸ“ Scanning: BPLD Dataset
#   ğŸ“ Scanning: Rice Dataset
#   ...
# âœ… Found 10,245 images across all datasets
# ğŸ“Š Analyzing images...
#   Analyzed 100/10245 images...
#   ...
# ğŸ” Detecting duplicates...
# âœ… Removed 1,832 exact duplicates
# ğŸ” Clustering similar images...
# âœ… Created 487 similarity clusters
# ğŸ“Š Creating train/val/test/holdout splits...
# âœ… Train: 5,040, Val: 1,080, Test: 1,080, Holdout: 813
# ğŸ“ Organizing merged dataset...
# ğŸ“ Generating reports...
# âœ… Dataset Merging Complete!
```

---

**Legend:**
- ğŸ“ Directory/Folder
- ğŸ“Š Data Processing
- ğŸ” Analysis/Search
- âœ… Success/Completion
- âš ï¸ Warning
- ğŸš€ Action/Start
